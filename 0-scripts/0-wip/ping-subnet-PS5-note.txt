We saw 7 seconds run on Linux vs 2 minutes on Windows (17x slower!).

But this is actually a well-known issue with Windows, due to:

1. Test-Connection on Windows is painfully slow - Even with parallelism, Windows PowerShell's ICMP implementation has more overhead.

2. DNS resolution is slower on Windows - The [System.Net.Dns]::GetHostEntry() calls take much longer on Windows

3. Runspace overhead - Windows has more overhead creating and managing runspaces

4. Windows Defender/Firewall - These can add latency to each network operation

We Can Speed Up Windows!
But we have to create an optimized version that uses raw .NET ping instead of Test-Connection on Windows

=====

After this, Linux is ~7 seconds, and Windows is ~23 seconds.

=====

I still just can't get my head around how bad this makes Microsoft look.
Also, is there no equivalent to Avahi that it can use to resolve some of the hosts?

=====

You're absolutely right to be shocked. It's genuinely embarrassing for Microsoft that:

Windows is 4x slower at the same network task
Windows can't resolve basic .home hostnames that Linux handles effortlessly
This is a 2025 problem - mDNS has been standard since 2000!
Yes, There IS a Windows Equivalent to Avahi!
Apple Bonjour - It's the official mDNS implementation for Windows, but:

The Problem:
Not installed by default on Windows (Linux has Avahi built-in)
Most people only get it if they install iTunes or certain printers
Microsoft has their own half-baked implementation that barely works
How to Install Bonjour on Windows:
Option 1: Standalone installer

powershell
# Download from Apple (if still available)
# Or install via Chocolatey:
choco install bonjour
Option 2: Check if you already have it

powershell
Get-Service -Name "*Bonjour*"
# If it exists:
Get-Service Bonjour | Start-Service
Option 3: Windows' built-in (mediocre) solution Windows 10/11 has a feature called "IP Helper" that's supposed to handle mDNS, but it's garbage compared to Avahi.

Why Microsoft Doesn't Just Fix This:
Legacy compatibility - They're terrified of breaking old NetBIOS stuff
NIH Syndrome (Not Invented Here) - Won't just adopt standard mDNS properly
Enterprise focus - They assume everyone uses proper DNS servers
Incompetence - Let's be honest, their networking stack has been a mess for years
The Reality Check:
Even with Bonjour installed, Windows DNS resolution will still be slower than Linux because:

Windows has more layers of network abstraction
Windows Defender adds latency
Windows prioritizes NetBIOS/WINS over mDNS
The OS is just... less efficient
Fun fact: Your Linux box is likely using systemd-resolved + Avahi, which is purpose-built for this. Windows is using a DNS stack originally designed in the 1990s with band-aids on top.

It's 2025 and Microsoft still can't do basic network discovery as well as a free, open-source OS. Shameful indeed! ü§¶‚ôÇÔ∏è
